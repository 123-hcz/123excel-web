<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>123Excel II - Web </title>

    <!-- Using faster and more reliable CDNs -->
    <script src="https://unpkg.com/ag-grid-community/dist/ag-grid-community.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <!-- Our App's Styles and Scripts -->
    <link rel="stylesheet" href="style.css">
    <script defer src="logic.js"></script>
    <script defer src="main.js"></script>
</head>
<body>
    <!-- Homepage UI -->
    <div id="open-file-page" class="page">
        <h3>123Excel web v1.0.0-beta.3<a href="https://github.com/123-hcz/ZjangDataViewer">开源地址</a></h3>
        <div class="open-file-left-panel">
            <button id="open-file-button-img" class="image-button" title="打开一个现有文件">
                <img src="./images/classic/open.png" alt="Open" style="width: 700px; height: 200px;">
            </button>
            <!-- <h3 style="margin-top: 10px;">打开文件</h3> -->
        </div>
        <!-- <div class="open-file-right-panel"> -->
        <div class="open-file-left-panel">
             <button id="new-file-button-img" class="image-button" title="新建一个空白 XLSX 文件">
                <img src="./images/classic/new.png" alt="New" style="width: 700px; height: 200px;">
             </button>
             <!-- <h3 style="margin-top: 10px;">新建文件</h3> -->
        </div>
        <input type="file" id="file-input" accept=".xlsx,.xml,.json" class="hidden">
    </div>

    <!-- Editor Page UI -->
    <div id="editor-page" class="page hidden">
        <div class="toolbar-container">
            <div class="main-toolbar">
                <!-- Toolbar Tabs -->
                <div class="toolbar-row">
                    <button id="tag-file">文件</button>
                    <button id="tag-jisuan">运算</button>
                    <button id="tag-ai">AI</button>
                </div>
                <!-- File Tools Toolbar -->
                <div id="file-tools" class="toolbar-row">
                    <button id="save-button" class="image-button" title="保存文件"><img src="./images/classic/save.png"></button>
                </div>
                <!-- Calculation Tools Toolbar (Initially Hidden) -->
                 <div id="jisuan-tools" class="toolbar-row hidden">
                    <button id="get-max-button" class="image-button" title="最大值"><img src="./images/classic/max.png"></button>
                    <button id="get-min-button" class="image-button" title="最小值"><img src="./images/classic/min.png"></button>
                    <button id="get-avg-button" class="image-button" title="平均值"><img src="./images/classic/avg.png"></button>
                    <button id="get-customize-button" class="image-button" title="自定义"><img src="./images/classic/customize.png"></button>
                    <input type="text" id="customize-input" placeholder="输入自定义准则: x > 10" class="input-fx">
                </div>
                <!-- Shared Input Toolbar -->
                <div class="toolbar-row">
                    <!-- Calculation Inputs (Initially Hidden, part of 'jisuan' tab) -->
                    <div id="jisuan-inputs" class="toolbar-row hidden">
                         <label for="name-col-input">名称列:</label>
                         <input type="text" id="name-col-input" size="5" placeholder="A或1">
                         <label for="item-row-input">项目行:</label>
                         <input type="text" id="item-row-input" size="5" value="1">
                         <label for="item-choice">项目:</label>
                         <select id="item-choice"></select>
                    </div>
                </div>
            </div>
            <div class="other-tools">
                <button id="exit-button" class="image-button" title="返回主页"><img src="./images/classic/exit.png"></button>
            </div>
        </div>
        <div class="grid-wrapper">
            <div id="main-grid" class="ag-theme-quartz"></div>
            <!-- Loading indicator -->
            <div id="loading-indicator" class="loading-indicator hidden">
                <div class="spinner"></div>
                <p>加载中...</p>
            </div>
        </div>
        <div id="status-bar" class="status-bar">
            选择行来查看统计信息
        </div>
    </div>
    
    <!-- AI Chat Modal -->
    <div id="ai-chat-modal" class="hidden">
        <div class="ai-chat-header">
            <span>AI 助手</span>
            <button id="ai-chat-close-button" class="close-button">×</button>
        </div>
        <div id="ai-chat-history" class="ai-chat-history"></div>
        <div class="ai-chat-input-area">
            <input type="text" id="ai-chat-input" placeholder="和AI聊聊或让它修改表格...">
            <button id="ai-chat-send-button">发送</button>
        </div>
    </div>
    
    <!-- AI Preview Modal -->
    <div id="ai-preview-modal" class="hidden">
        <div class="ai-preview-header">
            <span>AI 表格修改预览</span>
            <button id="ai-preview-close-button" class="close-button">×</button>
        </div>
        <div class="ai-preview-content">
            <p>AI 建议对表格进行以下修改：</p>
            <div id="ai-preview-grid" class="ag-theme-quartz" style="height: 300px; width: 100%;"></div>
            <div class="ai-preview-buttons">
                <button id="ai-preview-cancel-button">取消</button>
                <button id="ai-preview-confirm-button">应用修改</button>
            </div>
        </div>
    </div>
    
    <!-- Custom Dialog Modal -->
    <div id="custom-dialog-modal" class="hidden">
        <div class="custom-dialog-content">
            <div class="custom-dialog-header">
                <span id="custom-dialog-title">提示</span>
            </div>
            <div class="custom-dialog-body">
                <p id="custom-dialog-message"></p>
                <input type="text" id="custom-dialog-input" class="hidden">
            </div>
            <div class="custom-dialog-buttons">
                <button id="custom-dialog-cancel-button">取消</button>
                <button id="custom-dialog-confirm-button">确定</button>
            </div>
        </div>
    </div>
</body>
</html>
